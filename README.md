# 1/f Fluctuation Generator (The Breath of Music) 🌊✨

**「冷凍保存」されたデジタル音源に、1/fゆらぎという「生命」を吹き込む蘇生装置 (Completed)**

## 📖 概要 (Overview)
**音楽を「聴く」ものから、「呼吸する」ものへ。**

市販の音楽（CD/MP3）は、レコーディングされた瞬間に「永遠に変わらないデータ」として冷凍保存される。何度再生しても、全く同じ波形、全く同じタイミング。しかし、人間は本能的に「変化しないもの」に対して無意識の閉塞感を感じる。

本プロジェクト **"1/f Fluctuation Generator"** は、自然界に遍在する「1/fゆらぎ（ピンクノイズ）」を数学的に生成し、音楽の構成要素（音量・定位・ピッチ・音色・残響）を動的に変調させるツールである。

単なるLo-Fiフィルターではなく、**「演奏の熱量」や「空間の呼吸」** をシミュレートし、二度と同じ瞬間が訪れない「一回性の音楽体験」を再構築する。

## 目的
**「癒やし」を超えた、「感情の増幅（Emotional Remastering）」へ。**

当初は、あらゆる曲を1/f揺らぎのルールに乗っけて強制的にヒーリングミュージックにしてしまおうというコンセプトで始まった。しかし、開発過程において、パラメータの選択次第で　**「音質を劣化させずに、ダイナミクスだけを激しく揺らす」**　というアプローチを発見。

これにより、既存の楽曲に対し、まるでプロのミュージシャンがその場で感情を込めて演奏しているかのような **「ライブ感」**
を付与することに成功した。**「癒し」**から **「興奮」**まで、幅広く感情に訴えることが可能である。

## 📂 機能 (Features)

### 1. The 5 Elements of Fluctuation (5大要素の変調)
音楽を構成する5つのパラメータすべてが、独立した1/fゆらぎ計算によって有機的に連動します。
* **Volume (Dynamics):** 人間の演奏のブレや、感情の高ぶりに伴う音圧の変化を再現。
* **Pan (Spatial):** 聴き手の頭の周りを浮遊するような、予測不能な定位移動。
* **Pitch (Wow/Flutter):** アナログテープの伸びや、微細なピッチのうねりを再現。
* **Timbre (Filter Breath):** ローパスフィルタを揺らし、音が「こもる（陰）」瞬間と「晴れる（陽）」瞬間を行き来させる。
* **Reverb (Space Breathing):** 空間の広さを動的に伸縮させ、響きに包まれる感覚を演出。

### 2. Live Mode (原曲超え)
開発中に発見された「禁断のプリセット」。
* **Concept:** Timbre（音色劣化）をあえて `0` にし、その他のパラメータを `3.0`（通常の3倍）という極端な値に設定する。
* **Effect:** 音質はクリアなまま、演奏のグルーヴとダイナミクスだけがドーピングされ、原曲を超えるエモーショナルな体験を提供する。

### 3. Real-time Visualization (可視化)
* **Waveform Zoom:** 波形の角が取れ、有機的に変化する様子を0.01秒単位で監視。
* **PSD Analysis:** パワースペクトル密度を解析し、理想的な「1/fライン（緑の点線）」と生成された音楽の特性を比較表示。

## 📂 ディレクトリ構成 (Directory Structure)

```text
Music_One_F/
│
├── README.md              # 本ドキュメント
├── requirements.txt       # 依存ライブラリ (librosa, sounddevice, scipy, numpy, etc.)
│
├── main_gui.py            # 【GUIエントリーポイント】 スレッド管理と再生・描画の統合
├── gui_play.py            # 【再生エンジン】 SoundDeviceを用いた非同期再生
├── one_f_generator.py     # 【心臓部】 FFT/IFFTを用いたピンクノイズ生成クラス
│
├── syn_volume.py          # 音量変調モジュール（移動平均によるスムージング）
├── syn_pan.py             # 定位変調モジュール（Constant Power Panning）
├── syn_pitch.py           # ピッチ変調モジュール（可変速リサンプリング）
├── syn_timbre.py          # 音色変調モジュール（filtfiltゼロ位相フィルタ）
└── syn_reverb.py          # 残響変調モジュール（IR自動生成とFFT畳み込み）

## 💻 開発環境 (Development Environment)
* **OS:** Windows 11
* **Language:** Python 3.13
* **GUI Framework:** Tkinter (Thread-safe implementation)

## 🛠️ 技術的アプローチ (Technical Approach)

### 1. 1/f Noise Generation (ピンクノイズの生成)
* ホワイトノイズを FFT（高速フーリエ変換）で周波数領域に変換し、振幅を 1/√f でスケーリングした後、IFFT で時間領域に戻すことで数学的に純粋なピンクノイズを生成している。

### 2. Signal Processing (信号処理)
* **FFT Convolution**: 計算負荷の高いリバーブ処理において、FFT を用いた高速畳み込み（`fftconvolve`）を採用し、処理時間を大幅に短縮した。
* **Zero-phase Filtering**: Timbre 制御において `filtfilt` を採用。位相ズレを排除し、原音と加工音をクリアにブレンドすることを可能にしている。
* **Smoothing**: 生成された 1/f 信号に対し、移動平均フィルタ（Window Size: 2000 samples）を適用。デジタル特有のジッパーノイズを排除し、滑らかなパラメータ変化を実現した。

### 3. Thread Safety (スレッドセーフ設計)
* 重い信号処理はバックグラウンドスレッドで実行し、GUI のフリーズを回避している。
* 処理完了後、`root.after()` を用いてメインスレッドにコールバックし、グラフ描画と再生を安全に行うアーキテクチャを採用した。

## 💡 補足 (Supplementary)

### パラメータ設定のコツ
* **BGM として聴く場合**: 全パラメータを `0.2` 〜 `0.5` に設定（隠し味的な癒やし効果）。
* **ボーカル曲の場合**: `Pitch` を `0.0` に設定することで、人間の声特有の「宇宙人化（フォルマントの違和感）」を防ぐことができる。
* **ライブ化**: TimbreとPanを0にして、他のパラメータを3.0にすることで、ライブ会場にいるような音楽を聴くことができる。

### AI アシスタンス
* このプロジェクトは AI（Gemini）の補助を受けて、信号処理の最適化とアーキテクチャの設計を行いました。

---

## 📜 License
MIT © 2026 Cielfe
